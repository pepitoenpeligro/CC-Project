# R2. Design, Routes, Testing and HU's

Toda la historia de aprendizaje sobre el dise√±o de las diferentes "APIs" se puede encontrar en el [issue 71](https://github.com/pepitoenpeligro/cloudbanking/issues/71)

The proposed design, as discussed in the previous section, is based on four microservices programmed in different languages and with different frameworks. This gives us a practical view of the polyglot property of the microservices, and the capacity for interoperability that exists.

![](img/microservices-framework-graphic.png)

[Postman Documentation API](https://documenter.getpostman.com/view/13864499/TVzPoK3B)


#### Microservice 1:  Users 

*This microservice has been developed with Rust and the actix framework*


| Request route | Response |
|:---|---:|
| GET       /api/users        | 200 OK always. It returns the list of all (active) users in cloudbanking |
| GET       /api/users/{id}   | 200 OK if there is a user with this id. 404 Not Found if there is no user with that id in the system|
| POST      /api/users        | 201 CREATED if post body is correct. If not, middleware returns 400 Bad Request indicating a bad formed body|
| PUT       /api/users        | 201 CREATED if put body is correct. If not, middleware return 400 Bad Request indicating a bad formed body|
| DELETE    /api/users/{id}   | 200 OK if there is a user with this id. 404 Not Found if there is no user with that id in the system|

Every request handler (and response returned) is here: [cloudbanking/src/controller/routes_handlers.rs](https://github.com/pepitoenpeligro/cloudbanking/blob/master/src/controller/routes_handlers.rs)

Router is here: [cloudbanking/src/main](https://github.com/pepitoenpeligro/cloudbanking/blob/master/src/main.rs)


Middleware for check id: [cloudbanking/src/controller/middleware.rs](https://github.com/pepitoenpeligro/cloudbanking/blob/master/src/controller/middleware.rs)



#### Microservice 2:  Bank Accounts 

*This microservice has been developed with Rust and the warp framework*

| Request route | Response |
|:---|---:|
| GET       /accounts/{id}   | 200 OK if there is a bank account with this id. 404 Not Found if there is no account with that id in the system|
| POST      /accounts        | 201 CREATED if post body is correct. (There is no middleware implemented for returning 400, this is considered future job)|
| DELETE    /accounts/{id}   | 200 OK if there is a bank account with this id. 404 Not Found if there is no bank account with that id in the system|

Every request handler (and response returned) is here: [cloudbanking/account/src/bankaccount_module/routes_handlers.rs)](https://github.com/pepitoenpeligro/cloudbanking/blob/master/account/src/bankaccount_module/routes_handlers.rs)

Router is here: [cloudbanking/account/src/main.rs](https://github.com/pepitoenpeligro/cloudbanking/blob/master/account/src/main.rs)



#### Microservice 3:  Bank Cards

*This microservice has been developed with Nim and the jester framework*


| Request route | Response |
|:---|---:|
| GET       /cards/{id}   | 200 OK if there is a card with this id. 404 Not Found if there is no card with that id in the system|
| POST      /cards        | 201 CREATED if post body is correct. (There is no middleware implemented for returning 400, this is considered future job)|
| DELETE    /cards/{id}   | 200 OK if there is a card with this id. 404 Not Found if there is no card with that id in the system|


Router and handlers are here: [cloudbanking/card/src/jester_cards.nim](https://github.com/pepitoenpeligro/cloudbanking/blob/master/card/src/jester_cards.nim)


#### Microservice 4:  Bank Funds

*This microservice has been developed with Kotlin and the quarkus framework*


| Request route | Response |
|:---|---:|
| GET       /funds        | 200 OK always. It returns the list of all (active) funds in cloudbanking |
| GET       /funds/{id}   | 200 OK if there is a fund with this id. 404 Not Found if there is no fund with that id in the system|
| POST      /funds        | 201 CREATED if post body is correct. (There is no middleware implemented for returning 400, this is considered future job)|
| DELETE    /funds/{id}   | 200 OK if there is a fund with this id. 404 Not Found if there is no fund with that id in the system|


Service (injected), Handlers and Routes can be founded here: [cloudbanking/funds/src/main/kotlin/com/pepe/rest/resteasyjackson/FundResource.kt](https://github.com/pepitoenpeligro/cloudbanking/blob/master/funds/src/main/kotlin/com/pepe/rest/resteasyjackson/FundResource.kt)


The complete documentation (online) is available on the [postman website](https://documenter.getpostman.com/view/13864499/TVzPoK3B)